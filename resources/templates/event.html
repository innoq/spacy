{% extends "templates/base.html" %}
{% block title %}
{{session-name}}
{% endblock %}
{% block body %}

<header>
    <h1>{{session-name}}</h1>

    <nav>
        <ul>
            <li><a href="#up-next">Up Next</a></li>
            <li><a href="#sessions">Sessions</a></li>
            <li><a href="#queue">Queue</a></li>
            <li class="js-only"><a href="#notifications">Notifications</a></li>
        </ul>
    </nav>
</header>
<main>
    <up-next current-user="{{current-user}}">
        <h2 id="up-next">Up Next</h2>
        {% if next-up %}

        <details id="{{next-up.session.id}}">
            <summary>{{next-up.session.title}} - {{next-up.sponsor}}</summary>
            {{next-up.session.description}}
        </details>

        <p role="status">
            {% ifequal next-up.sponsor current-user %}
            You are currently next in line! Please select a slot for your session.
            {% endifequal %}
        </p>

        {% endif %}
    </up-next>
    <bulletin-board>
        <h2 id="sessions">Sessions</h2>
        <table>
            <thead>
                <tr>
                    <th>Room</th>
                    {% for time in times %}
                    <th>{{time}}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for room in rooms %}
                <tr>
                    <th>{{room}}</th>
                    {% for time in times %}
                    <td>
                        {% for slot in scheduled %}

                        {% ifequal room slot.room %}
                        {% ifequal time slot.time %}

                        <details id="{{slot.session.id}}">
                            <summary>
                                {{ slot.session.title }} - {{ slot.sponsor }}
                            </summary>
                            {{ slot.session.description }}
                        </details>

                        {% endifequal %}
                        {% endifequal %}

                        {% endfor %}
                    </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </bulletin-board>
    <waiting-queue>
        <h2 id="queue">Queue</h2>
        <ol>
            {% for item in waiting-queue %}
            <li>
                <details id="{{item.session.id}}">
                    <summary>
                        {{item.session.title}} - {{item.sponsor}}
                    </summary>
                    {{item.session.description}}
                </details>
            </li>
            {% endfor %}
        </ol>
        <hijax-form>
            <form method="POST" action="{{uris.spacy..app/submit-session}}">
                <label>
                    Title
                    <input type="text" name="title" required>
                </label>
                <label>
                    Description
                    <textarea name="description" required></textarea>
                </label>
                <button type="submit">Submit Session</button>
            </form>
        </hijax-form>
        <template>
            <li>
                <details id>
                    <summary>
                        <span data-slot="title"></span> - <span data-slot="sponsor"></span>
                    </summary>
                    <span data-slot="description"></span>
                </details>
            </li>
        </template>
    </waiting-queue>
    <user-notifications current-user="{{current-user}}" hidden role="log">
        <h2 id="notifications">Notifications</h2>
        <ul role="log"></ul>

        <template data-template="session-suggested">
            <li>
                Your session "<span data-slot="title"></span>" was received and placed in the queue
                <div data-slot="at"></div>
            </li>
        </template>
    </user-notifications>
    <fact-handler uri="{{uris.spacy..app/sse}}"></fact-handler>
</main>
{% endblock %}
